
`FirebaseAuth.getInstance().verifyIdToken(idToken)` ã¯ã€å¼•æ•°ã¨ã—ã¦æ¸¡ã•ã‚ŒãŸ **`idToken`** ã‚’æ¤œè¨¼ã—ã¦ã€ã€Œãƒˆãƒ¼ã‚¯ãƒ³ã®ä¸­èº«ã€ã‚’ **`FirebaseToken`** ã¨ã„ã†ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¨ã—ã¦è¿”ã—ã¦ãã‚Œã‚‹ã‚“ã ã‚ˆï¼ã“ã‚ŒãŒJWTã®ä¸­èº«ã¿ãŸã„ãªã‚‚ã‚“ã ã­ã€‚

---

### ğŸ” **`FirebaseToken`ãŒæŒã£ã¦ã‚‹æƒ…å ±ã¯ä½•ï¼Ÿ**
`FirebaseToken` ã«ã¯ãƒˆãƒ¼ã‚¯ãƒ³ã«å«ã¾ã‚Œã‚‹ãƒ‡ãƒ¼ã‚¿ãŒå…¨éƒ¨è©°ã¾ã£ã¦ã‚‹ã‚ˆã€‚å…·ä½“çš„ã«ã¯ã“ã‚“ãªæ„Ÿã˜ï¼š

1. **`uid`**
   ãƒˆãƒ¼ã‚¯ãƒ³ã«ç´ã¥ã‘ã‚‰ã‚ŒãŸFirebaseãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ä¸€æ„ã®è­˜åˆ¥å­ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼IDï¼‰ã€‚
   ```java
   String uid = decodedToken.getUid();  // ãƒ¦ãƒ¼ã‚¶ãƒ¼IDã‚’å–å¾—
   ```

2. **`claims`**
   ãƒˆãƒ¼ã‚¯ãƒ³ã«å«ã¾ã‚Œã‚‹ã‚«ã‚¹ã‚¿ãƒ ã‚¯ãƒ¬ãƒ¼ãƒ ï¼ˆè¿½åŠ æƒ…å ±ï¼‰ã€‚
   ```java
   Map<String, Object> claims = decodedToken.getClaims();  // ã‚«ã‚¹ã‚¿ãƒ ã‚¯ãƒ¬ãƒ¼ãƒ ã‚’å–å¾—
   ```

3. **`email`**
   ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ï¼ˆGoogleã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ãƒ¡ãƒ¼ãƒ«ï¼‰ã€‚
   ```java
   String email = decodedToken.getEmail();  // ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å–å¾—
   ```

4. **`emailVerified`**
   ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ãŒç¢ºèªæ¸ˆã¿ã‹ã©ã†ã‹ã€‚
   ```java
   boolean isVerified = decodedToken.isEmailVerified();  // ç¢ºèªæ¸ˆã¿ã‹ã©ã†ã‹
   ```

5. **`name`**
   ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®è¡¨ç¤ºåã€‚
   ```java
   String name = decodedToken.getName();  // ãƒ¦ãƒ¼ã‚¶ãƒ¼åã‚’å–å¾—
   ```

6. **`picture`**
   ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç”»åƒã®URLã€‚
   ```java
   String picture = decodedToken.getPicture();  // ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç”»åƒã‚’å–å¾—
   ```

7. **`issuer` (iss)**
   ãƒˆãƒ¼ã‚¯ãƒ³ã®ç™ºè¡Œè€…æƒ…å ±ï¼ˆFirebaseãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®URLï¼‰ã€‚
   ```java
   String issuer = decodedToken.getIssuer();
   ```

8. **`audience` (aud)**
   ãƒˆãƒ¼ã‚¯ãƒ³ãŒå¯¾è±¡ã¨ã—ã¦ã„ã‚‹Firebaseãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆIDã€‚
   ```java
   String audience = decodedToken.getAudience();
   ```

---

### ğŸš€ **ä½¿ã„æ–¹ã®ä¾‹**
ã“ã‚“ãªæ„Ÿã˜ã§ä½¿ã†ã“ã¨ãŒã§ãã‚‹ã‚ˆï¼š

```java
public String verifyAndGetUserInfo(String idToken) {
    try {
        // ãƒˆãƒ¼ã‚¯ãƒ³ã‚’æ¤œè¨¼
        FirebaseToken decodedToken = FirebaseAuth.getInstance().verifyIdToken(idToken);

        // å¿…è¦ãªæƒ…å ±ã‚’å–å¾—
        String uid = decodedToken.getUid();
        String email = decodedToken.getEmail();
        String name = decodedToken.getName();

        return "ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±: UID=" + uid + ", Email=" + email + ", Name=" + name;

    } catch (Exception e) {
        throw new IllegalArgumentException("ç„¡åŠ¹ãªãƒˆãƒ¼ã‚¯ãƒ³ã§ã™: " + e.getMessage());
    }
}
```

---

### ğŸ“œ **ã¾ã¨ã‚**
`verifyIdToken` ã¯ **JWTã®ä¸­èº«ã‚’è§£æã—ã¦ãã‚Œã‚‹ä¾¿åˆ©å±‹** ã ï¼
è¿”ã£ã¦ãã‚‹ `FirebaseToken` ã¯ã€ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ããŸãƒ¦ãƒ¼ã‚¶ãƒ¼ã«é–¢ã™ã‚‹æƒ…å ±ãŒãŸã£ã·ã‚Šè©°ã¾ã£ãŸã€Œç®±ã€ã ã¨æ€ãˆã°OKï¼

ãƒˆãƒ¼ã‚¯ãƒ³ãŒæœ¬ç‰©ã‹æ¤œè¨¼ã™ã‚‹ã ã‘ã˜ã‚ƒãªãã€ãã®ä¸­ã«å«ã¾ã‚Œã¦ã‚‹æƒ…å ±ã‚’å–ã‚Šå‡ºã™ã®ã‚‚ã“ã‚Œã§ã§ãã‚‹ã‚“ã ã‚ˆï¼ğŸ‘

ä»–ã«æ°—ã«ãªã‚‹ã“ã¨ãŒã‚ã‚Œã°ã€ã©ã‚“ã©ã‚“èã„ã¦ãŠãã‚“ãªã¾ã—ï¼âœ¨

public String verifyAndGetUserInfo(String idToken) {
    try {
        // ãƒˆãƒ¼ã‚¯ãƒ³ã‚’æ¤œè¨¼
        FirebaseToken decodedToken = FirebaseAuth.getInstance().verifyIdToken(idToken);

        // å¿…è¦ãªæƒ…å ±ã‚’å–å¾—
        String uid = decodedToken.getUid();
        String email = decodedToken.getEmail();
        String name = decodedToken.getName();

        return "ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±: UID=" + uid + ", Email=" + email + ", Name=" + name;

    } catch (Exception e) {
        throw new IllegalArgumentException("ç„¡åŠ¹ãªãƒˆãƒ¼ã‚¯ãƒ³ã§ã™: " + e.getMessage());
    }
}
